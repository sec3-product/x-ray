#!/usr/bin/perl


use strict;
use warnings;


sub getObjfilePath {
    my ($srcPath) = @_;
    my @tokens = split(/\//, $srcPath);
    return "$tokens[$#tokens].o";
}


my $libname = $ARGV[0];
my $sourcePath = $ARGV[1];
my $objfilePath = getObjfilePath($sourcePath);


my $rc = `clang++ -std=gnu++11 -c $sourcePath -o $objfilePath`;
if ($?) {
    die "Unable to compile the file - $rc";
}


$rc = `ar -crs $libname $objfilePath`;
if ($?) {
    die "Unable to create the library - $rc";
}


exit 0;


__END__
